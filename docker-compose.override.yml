version: '3.5'
services:
  web:
    build: '.'
    ports:
     - "60000:80"
    environment: 
      SENTRY_DSN: ${SENTRY_DSN}
  watch:
    external_links:
      - sentry-server:sentry
    environment: 
      SENTRY_DSN: ${SENTRY_DSN}
  generation:
    external_links:
      - sentry-server:sentry
    environment: 
      SENTRY_DSN: ${SENTRY_DSN}
  nginx:
    image: 'nginx'
    ports:
      - 80:80
      - 443:443
    volumes:
      - ${CSHEET_STORAGE:-'/srv/csheet'}/nginx/html:/usr/share/nginx/html
      - type: bind
        source: ${CSHEET_STORAGE:-'/srv/csheet'}/nginx/conf
        target: /etc/nginx
        read_only: true
    