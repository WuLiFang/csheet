视频
=============

视频是色板的基本内容单位。

每个视频会对应多个文件和多个任务。

视频文件分为几个类型(role):

- thumb: 缩略图，由大图自动生成。
- poster: 大图，在有原始视频并且未设置时会从原始视频转换自动生成。
- preview: 预览，用于在网页上展示，由原始视频转码为 mp4。
- src: 原始视频。

src -> preview
src -> poster -> thumb

自动生成的文件路径为
``<文件存放路径>/cache/
<文件 sha256 1-2位>/
<文件 sha256 3-4位>/
<文件 sha256 5-64位>/
<文件名>``。

通过对比硬盘上的文件修改日期和数据库中的文件修改日期，
色板服务器自动检查视频相关的文件修改。
按顺序检查前端标记为需要更新的视频，
上次检查时间越近的排在越后面。

所有相对路径都是相对于 ``STORAGE`` :ref:`环境变量` 设置的路径

数据结构
--------------

视频(Video)
~~~~~~~~~~~~~~

uuid

  类型: String

  视频全局ID。

label

  类型: String

  视频名称。

src

  类型: Path

  原始视频文件路径。

src_mtime

  类型: Float

  原始视频文件在硬盘上修改时间。

src_atime

  类型: Float

  原始视频文件来自色板的最近一次访问时间。
  
